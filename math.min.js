/**
 * math.js
 * https://github.com/josdejong/mathjs
 *
 * Math.js is an extensive math library for JavaScript and Node.js,
 * It features real and complex numbers, units, matrices, a large set of
 * mathematical functions, and a flexible expression parser.
 *
 * @version 0.6.0-SNAPSHOT
 * @date    2013-04-11
 *
 * @license
 * Copyright (C) 2013 Jos de Jong <wjosdejong@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
(function(){function e(e){return e instanceof Boolean||"boolean"==typeof e}function n(e,n){var t=W.type.Chain,r=Array.prototype.slice;t.prototype[e]="function"==typeof n?function(){var e=[this.value].concat(r.call(arguments,0));return new t(n.apply(this,e))}:new t(n)}function t(e,n){if(this.constructor!=t)throw new SyntaxError("Complex constructor must be called with the new operator");if(null!=e&&!g(e)||null!=n&&!g(n))throw new TypeError("Two numbers or a single string expected in Complex constructor");this.re=e||0,this.im=n||0}function r(e){if(this.constructor!=r)throw new SyntaxError("Matrix constructor must be called with the new operator");if(e instanceof r||e instanceof d)this._data=e.toArray();else if(e instanceof Array)this._data=e;else{if(null!=e)throw new TypeError("Unsupported type of data ("+W.typeof(e)+")");this._data=[]}this._size=Z.size(this._data)}function i(e,n){if(!g(e)||!w(e))throw new TypeError("Index must be an integer (value: "+e+")");if(1>e)throw new RangeError("Index out of range ("+e+" < 1)");if(n&&e>n)throw new RangeError("Index out of range ("+e+" > "+n+")")}function a(e,n){return i(n,e.length),e[n-1]}function o(e,n){return n.forEach(function(n){e=a(e,n)}),W.clone(e)}function f(e,n){var t=n[0];return t.map?t.map(function(n){return a(e,n)}):[a(e,t)]}function s(e,n){var t=n[0],r=n[1];if(t.map)return r.map?t.map(function(n){var t=a(e,n);return r.map(function(e){return a(t,e)})}):t.map(function(n){return[a(a(e,n),r)]});if(r.map){var i=a(e,t);return[r.map(function(e){return a(i,e)})]}return[[a(a(e,t),r)]]}function u(e,n,t){var r=t==n.length-1,i=n[t],o=function(i){var o=a(e,i);return r?o:u(o,n,t+1)};return i.map?i.map(o):[o(i)]}function c(e,n,t){if(i(n),t instanceof Array)throw new TypeError("Dimension mismatch, value expected instead of array");e[n-1]=t}function l(e,n,t,r){var a=!1;t.length>n.length&&(a=!0);for(var o=0;t.length>o;o++){var f=t[o];i(f),(null==n[o]||f>n[o])&&(n[o]=f,a=!0)}a&&Z.resize(e,n,0);var s=n.length;t.forEach(function(n,t){s-1>t?e=e[n-1]:e[n-1]=r})}function h(e,n,t,r){var a=t[0];i(a),a>n[0]&&Z.resize(e,[a],0),e[a-1]=r}function m(e,n,t,r){var a=t[0],o=t[1];i(a),i(o);var f=!1;a>(n[0]||0)&&(n[0]=a,f=!0),o>(n[1]||0)&&(n[1]=o,f=!0),f&&Z.resize(e,n,0),e[a-1][o-1]=r}function p(e,n,t,r,i){var a=r==t.length-1,o=t[r],f=function(o,f){if(a)c(e,o,i[f]),e.length>(n[r]||0)&&(n[r]=e.length);else{var s=e[o-1];s instanceof Array||(e[o-1]=s=[s],e.length>(n[r]||0)&&(n[r]=e.length)),p(s,n,t,r+1,i[f])}};if(o.map){var s=o.size&&o.size()||o.length;if(s!=i.length)throw new RangeError("Dimensions mismatch ("+s+" != "+i.length+")");o.map(f)}else f(o,0)}function v(e){for(var n=0,t=e.length;t>n;n++){var r=e[n];r instanceof Array?v(r):void 0==r&&(e[n]=0)}}function g(e){return e instanceof Number||"number"==typeof e}function w(e){return e==Math.round(e)}function d(e,n,t){if(this.constructor!=d)throw new SyntaxError("Range constructor must be called with the new operator");if(null!=e&&!g(e))throw new TypeError("Parameter start must be a number");if(null!=t&&!g(t))throw new TypeError("Parameter end must be a number");if(null!=n&&!g(n))throw new TypeError("Parameter step must be a number");this.start=null!=e?e:0,this.end=null!=t?t:0,this.step=null!=n?n:1}function y(e){return e instanceof String||"string"==typeof e}function E(e,n){if(this.constructor!=E)throw Error("Unit constructor must be called with the new operator");if(null!=e&&!g(e))throw Error("First parameter in Unit constructor must be a number");if(null!=n&&!y(n))throw Error("Second parameter in Unit constructor must be a string");if(null!=n){var t=N(n);if(!t)throw Error('String "'+n+'" is no unit');this.unit=t.unit,this.prefix=t.prefix,this.hasUnit=!0}else this.unit=E.UNIT_NONE,this.prefix=E.PREFIX_NONE,this.hasUnit=!1;null!=e?(this.value=this._normalize(e),this.hasValue=!0,this.fixPrefix=!1):(this.value=this._normalize(1),this.hasValue=!1,this.fixPrefix=!0)}function N(e){for(var n=E.UNITS,t=0,r=n.length;r>t;t++){var i=n[t];if(Z.endsWith(e,i.name)){var a=e.length-i.name.length,o=e.substring(0,a),f=i.prefixes[o];if(void 0!==f)return{unit:i,prefix:f}}}return null}function O(e,n){var t=void 0;if(2==arguments.length){var r=W.typeof(n);t="Function "+e+" does not support a parameter of type "+r}else if(arguments.length>2){for(var i=[],a=1;arguments.length>a;a++)i.push(W.typeof(arguments[a]));t="Function "+e+" does not support a parameters of type "+i.join(", ")}else t="Unsupported parameter in function "+e;return new TypeError(t)}function x(e,n,t,r){var i="Wrong number of arguments in function "+e+" ("+n+" provided, "+t+(void 0!=r?"-"+r:"")+" expected)";return new SyntaxError(i)}function b(e,n){var r=n.re*n.re+n.im*n.im;return new t((e.re*n.re+e.im*n.im)/r,(e.im*n.re-e.re*n.im)/r)}function M(e,n){return new t(e.re*n.re-e.im*n.im,e.re*n.im+e.im*n.re)}function A(e,n){var t=W.log(e),r=W.multiply(t,n);return W.exp(r)}function S(e,n){var t=Math.pow(10,void 0!=n?n:W.options.precision);return Math.round(e*t)/t}function T(e,n,t,r){if(t>r){if(e.length!=n.length)throw Error("Dimensions mismatch ("+e.length+" != "+n.length+")");for(var i=[],a=0;e.length>a;a++)i[a]=T(e[a],n[a],t,r+1);return i}return e.concat(n)}function U(e,n,t){var r=W.multiply,i=W.subtract;if(1==n)return e[0][0];if(2==n)return i(r(e[0][0],e[1][1]),r(e[1][0],e[0][1]));for(var a=0,o=0;t>o;o++){var f=L(e,n,t,0,o);a+=r(r((o+1)%2+(o+1)%2-1,e[0][o]),U(f,n-1,t-1))}return a}function L(e,n,t,r,i){for(var a,o=[],f=0;n>f;f++)if(f!=r){a=o[f-(f>r)]=[];for(var s=0;t>s;s++)s!=i&&(a[s-(s>i)]=e[f][s])}return o}function R(e,n,t){var r,i,a,o,f,s=W.add,u=W.unaryminus,c=W.multiply,l=W.divide;if(1==n){if(o=e[0][0],0==o)throw Error("Cannot calculate inverse, determinant is zero");return[[l(1,o)]]}if(2==n){var h=W.det(e);if(0==h)throw Error("Cannot calculate inverse, determinant is zero");return[[l(e[1][1],h),l(u(e[0][1]),h)],[l(u(e[1][0]),h),l(e[0][0],h)]]}var m=e.concat();for(r=0;n>r;r++)m[r]=m[r].concat();for(var p=W.eye(n).valueOf(),v=0;t>v;v++){for(r=v;n>r&&0==m[r][v];)r++;if(r==n||0==m[r][v])throw Error("Cannot calculate inverse, determinant is zero");r!=v&&(f=m[v],m[v]=m[r],m[r]=f,f=p[v],p[v]=p[r],p[r]=f);var g=m[v],w=p[v];for(r=0;n>r;r++){var d=m[r],y=p[r];if(r!=v){if(0!=d[v]){for(a=l(u(d[v]),g[v]),i=v;t>i;i++)d[i]=s(d[i],c(a,g[i]));for(i=0;t>i;i++)y[i]=s(y[i],c(a,w[i]))}}else{for(a=g[v],i=v;t>i;i++)d[i]=l(d[i],a);for(i=0;t>i;i++)y[i]=l(y[i],a)}}}return p}function _(e){if(1==e.length)return _(e[0]);for(var n=0,t=e.length;t>n;n++){var r=e[n];r instanceof Array&&(e[n]=_(r))}return e}function z(e){for(var n=W.larger,t=e[0],r=1,i=e.length;i>r;r++){var a=e[r];n(a,t)&&(t=a)}return t}function q(e,n,t){for(var r=W.larger,i=[],a=0;t>a;a++){for(var o=e[0][a],f=1;n>f;f++){var s=e[f][a];r(s,o)&&(o=s)}i[a]=o}return i}function I(e){for(var n=W.smaller,t=e[0],r=1,i=e.length;i>r;r++){var a=e[r];n(a,t)&&(t=a)}return t}function P(e,n,t){for(var r=W.smaller,i=[],a=0;t>a;a++){for(var o=e[0][a],f=1;n>f;f++){var s=e[f][a];r(s,o)&&(o=s)}i[a]=o}return i}function C(e){return"function"==typeof e||g(e)||y(e)||e instanceof t||e instanceof E}function B(){}function G(e,n,t){this.name=e,this.fn=n,this.params=t}function V(e){this.value=e}function D(e){this.nodes=e||[]}function k(){this.params=[],this.visible=[]}function F(e,n,t,r){this.name=e,this.params=n,this.expr=t,this.result=r}function H(e,n){this.object=e,this.params=n}function j(e,n,t,r,i){this.name=e,this.variables=t,this.values=[];for(var a=0,o=this.variables.length;o>a;a++)this.values[a]=function(){var e=function(){return e.value};return e.value=void 0,e}();this.def=this.createFunction(e,n,t,r),this.result=i}function Y(e,n){throw Error('Constructor "'+e+'" has been replaced by '+'constructor method "'+n+'" in math.js v0.5.0')}var W={type:{},expr:{node:{}},options:{precision:10}};"undefined"!=typeof module&&module.exports!==void 0&&(module.exports=W),"undefined"!=typeof exports&&(exports=W),"undefined"!=typeof require&&"undefined"!=typeof define&&define(function(){return W}),"undefined"!=typeof window&&(window.math=W);var Z=function(){function e(n){if(n instanceof Array){var t=n.length;if(t){var r=e(n[0]);return 0==r[0]?[0].concat(r):[t].concat(r)}return[t]}return[]}function n(e,t,r){var i,a=e.length;if(a!=t[r])throw new RangeError("Dimension mismatch ("+a+" != "+t[r]+")");if(t.length-1>r){var o=r+1;for(i=0;a>i;i++){var f=e[i];if(!(f instanceof Array))throw new RangeError("Dimension mismatch ("+(t.length-1)+" < "+t.length+")");n(e[i],t,o)}}else for(i=0;a>i;i++)if(e[i]instanceof Array)throw new RangeError("Dimension mismatch ("+(t.length+1)+" > "+t.length+")")}function t(e,n,r){if(n.length-1>r){var i=e[0];if(1!=e.length||!(i instanceof Array))throw new RangeError("Dimension mismatch ("+e.length+" > 0)");t(i,n,r+1)}else if(e.length)throw new RangeError("Dimension mismatch ("+e.length+" > 0)")}function i(e,n,t,r){if(!(e instanceof Array))throw new TypeError("Array expected");var a=e.length,o=n[t];if(a!=o){if(o>e.length)for(var f=e.length;o>f;f++)e[f]=r?W.clone(r):0;else e.length=n[t];a=e.length}if(n.length-1>t){var s=t+1;for(f=0;a>f;f++)u=e[f],u instanceof Array||(u=[u],e[f]=u),i(u,n,s,r)}else for(f=0;a>f;f++){for(var u=e[f];u instanceof Array;)u=u[0];e[f]=u}}var a={};return a.formatNumber=function(e,n){if(1/0===e)return"Infinity";if(e===-1/0)return"-Infinity";if(0/0===e)return"NaN";var t=Math.abs(e);if(t>1e-4&&1e6>t||0==t)return S(e,n)+"";var r=Math.round(Math.log(t)/Math.LN10),i=e/Math.pow(10,r);return S(i,n)+"E"+r},a.formatArray=function(e){if(e instanceof Array){for(var n="[",t=e.length,r=0;t>r;r++)0!=r&&(n+=", "),n+=a.formatArray(e[r]);return n+="]"}return W.format(e)},a.formatArray2d=function(e){var n="[",t=a.size(e);if(2!=t.length)throw new RangeError("Array must be two dimensional (size: "+a.formatArray(t)+")");for(var r=t[0],i=t[1],o=0;r>o;o++){0!=o&&(n+="; ");for(var f=e[o],s=0;i>s;s++){0!=s&&(n+=", ");var u=f[s];void 0!=u&&(n+=W.format(u))}}return n+="]"},a.argsToArray=function(e){var n;if(0==e.length)n=[];else if(1==e.length)n=e[0],n instanceof r&&(n=n.toVector()),n instanceof d&&(n=n.valueOf()),n instanceof Array||(n=[n]);else{n=[];for(var t=0;e.length>t;t++)n[t]=e[t]}return n},a.endsWith=function(e,n){var t=e.length-n.length,r=e.length;return e.substring(t,r)===n},a.randomUUID=function(){var e=function(){return Math.floor(65536*Math.random()).toString(16)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},a.map=function(e,n){if(e instanceof Array||e instanceof r||e instanceof d)return e.map(function(e){return n(e)});throw new TypeError("Array expected")},a.map2=function(e,n,t){var i,o,f;if(e instanceof r||n instanceof r)return new r(a.map2(e.valueOf(),n.valueOf(),t));if(e instanceof d||n instanceof d)return new r(a.map2(e.valueOf(),n.valueOf(),t));if(e instanceof Array)if(n instanceof Array){if(e.length!=n.length)throw new RangeError("Dimension mismatch ("+e.length+" != "+n.length+")");for(i=[],o=e.length,f=0;o>f;f++)i[f]=t(e[f],n[f])}else for(i=[],o=e.length,f=0;o>f;f++)i[f]=t(e[f],n);else if(n instanceof Array)for(i=[],o=n.length,f=0;o>f;f++)i[f]=t(e,n[f]);else i=t(e,n);return i},a.forEach=function(e,n){if(e instanceof Array)e.forEach(n);else for(var t in e)e.hasOwnProperty(t)&&n(e[t],t,e)},a.mapObject=function(e,n){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=n(e[r]));return t},a.deepEqual=function(e,n){var t,r,i;if(e instanceof Array){if(!(n instanceof Array))return!1;for(r=0,i=e.length;i>r;r++)if(!a.deepEqual(e[r],n[r]))return!1;return!0}if(e instanceof Object){if(n instanceof Array||!(n instanceof Object))return!1;for(t in e)if(e.hasOwnProperty(t)&&!a.deepEqual(e[t],n[t]))return!1;for(t in n)if(n.hasOwnProperty(t)&&!a.deepEqual(e[t],n[t]))return!1;return!0}return e.valueOf()==n.valueOf()},a.size=function(n){var t=e(n);return a.validate(n,t),t},a.validate=function(e,r){var i=0==r.length;if(i){if(e instanceof Array)throw new RangeError("Dimension mismatch ("+e.length+" != 0)")}else{var o=-1!=r.indexOf(0);o?(r.forEach(function(e){if(0!=e)throw new RangeError("Invalid size, all dimensions must be either zero or non-zero (size: "+a.formatArray(r)+")")}),t(e,r,0)):n(e,r,0)}},a.resize=function(e,n,t){if(!(n instanceof Array))throw new TypeError("Size must be an array (size is "+W.typeof(n)+")");n.forEach(function(e){if(!g(e)||!w(e)||0>e)throw new TypeError("Invalid size, must contain positive integers (size: "+a.formatArray(n)+")")});var r=-1!=n.indexOf(0);r&&n.forEach(function(e){if(0!=e)throw new RangeError("Invalid size, all dimensions must be either zero or non-zero (size: "+a.formatArray(n)+")")}),i(e,n,0,t)},Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var n=0;this.length>n;n++)if(this[n]==e)return n;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,n){for(var t=0,r=this.length;r>t;++t)e.call(n||this,this[t],t,this)}),Array.prototype.map||(Array.prototype.map=function(e,n){var t,r,i;if(null==this)throw new TypeError(" this is null or not defined");var a=Object(this),o=a.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(n&&(t=n),r=Array(o),i=0;o>i;){var f,s;i in a&&(f=a[i],s=e.call(t,f,i,a),r[i]=s),i++}return r}),Array.prototype.every||(Array.prototype.every=function(e){"use strict";if(null==this)throw new TypeError;var n=Object(this),t=n.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=arguments[1],i=0;t>i;i++)if(i in n&&!e.call(r,n[i],i,n))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e){"use strict";if(null==this)throw new TypeError;var n=Object(this),t=n.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=arguments[1],i=0;t>i;i++)if(i in n&&e.call(r,n[i],i,n))return!0;return!1}),a}();W.type.Chain=function K(e){if(!(this instanceof K))throw new SyntaxError("Chain constructor must be called with the new operator");this.value=e||void 0},W.type.Chain.prototype={done:function(){return this.value},get:function(){var e=this.value;if(!e)throw Error("Value in chain is undefined");if(e.get)return new W.type.Chain(e.get.apply(e,arguments));if(e instanceof Array)return e=new r(e),new W.type.Chain(e.get.apply(e,arguments).valueOf());throw Error("Value in chain has no method get")},set:function(){var e=this.value;if(!e)throw Error("Value in chain is undefined");if(e.set)return new W.type.Chain(e.set.apply(e,arguments));if(e instanceof Array)return e=new r(e),new W.type.Chain(e.set.apply(e,arguments).valueOf());throw Error("Value in chain has no method set")},valueOf:function(){return this.value},toString:function(){return W.format(this.value)}},W.type.Complex=t,function(){function e(){for(;" "==c||"	"==c;)i()}function n(e){return e>="0"&&"9">=e||"."==e}function r(e){return e>="0"&&"9">=e}function i(){u++,c=s[u]}function a(e){u=e,c=s[u]}function o(){var e="",t=u;if("+"==c?i():"-"==c&&(e+=c,i()),!n(c))return a(t),null;for(;n(c);)e+=c,i();if("E"==c||"e"==c){if(e+=c,i(),("+"==c||"-"==c)&&(e+=c,i()),!r(c))return a(t),null;for(;r(c);)e+=c,i()}return e}function f(){var e=s[u+1];if("I"==c||"i"==c)return i(),"1";if(!("+"!=c&&"-"!=c||"I"!=e&&"i"!=e)){var n="+"==c?"1":"-1";return i(),i(),n}return null}var s,u,c;t.parse=function(n){if(s=n,u=-1,c="",!y(s))return null;i(),e();var r=o();if(r){if("I"==c||"i"==c)return i(),e(),c?null:new t(0,Number(r));e();var a=c;if("+"!=a&&"-"!=a)return e(),c?null:new t(Number(r),0);i(),e();var l=o();if(l){if("I"!=c&&"i"!=c)return null;i()}else if(l=f(),!l)return null;return"-"==a&&(l="-"==l[0]?"+"+l.substring(1):"-"+l),i(),e(),c?null:new t(Number(r),Number(l))}return(r=f())?(e(),c?null:new t(0,Number(r))):null}}(),t.prototype.clone=function(){return new t(this.re,this.im)},t.prototype.toString=function(){var e="",n=Z.formatNumber(this.re),t=Z.formatNumber(this.im);return e=0==this.im?n:0==this.re?1==this.im?"i":-1==this.im?"-i":t+"i":this.im>0?1==this.im?n+" + i":n+" + "+t+"i":-1==this.im?n+" - i":n+" - "+Z.formatNumber(Math.abs(this.im))+"i"},W.type.Matrix=r,r.prototype.get=function(e){var n;if(e instanceof r)n=e.isVector(),e=e.valueOf();else{if(!(e instanceof Array))throw new TypeError("Unsupported type of index "+W.typeof(e));n=!e.some(function(e){return e.forEach})}if(e.length!=this._size.length)throw new RangeError("Dimension mismatch ("+e.length+" != "+this._size.length+")");if(n)switch(e.length){case 1:return a(this._data,e[0]);case 2:return a(a(this._data,e[0]),e[1]);default:return o(this._data,e)}else switch(e.length){case 1:return new r(f(this._data,e));case 2:return new r(s(this._data,e));default:return new r(u(this._data,e,0))}},r.prototype.set=function(e,n){var t;if(e instanceof r)t=e.isVector(),e=e.valueOf();else{if(!(e instanceof Array))throw new TypeError("Unsupported type of index "+W.typeof(e));t=!e.some(function(e){return e.forEach})}if((n instanceof r||n instanceof d)&&(n=n.valueOf()),e.length<this._size.length)throw new RangeError("Dimension mismatch ("+e.length+" != "+this._size.length+")");if(t){if(0!=W.size(n).length)throw new TypeError("Scalar value expected");switch(e.length){case 1:h(this._data,this._size,e,n);break;case 2:m(this._data,this._size,e,n);break;default:l(this._data,this._size,e,n)}}else{var i=this._size.concat();p(this._data,i,e,0,n),Z.deepEqual(this._size,i)||(v(this._data),this.resize(i))}return this},r.prototype.resize=function(e,n){Z.resize(this._data,e,n),this._size=W.clone(e)},r.prototype.clone=function(){var e=new r;return e._data=W.clone(this._data),e._size=W.clone(this._size),e},r.prototype.size=function(){return this._size},r.prototype.map=function(e){var n=this,t=new r,i=[],a=function(t,r){return t instanceof Array?t.map(function(e,n){return i[r]=n+1,a(e,r+1)}):e(t,i,n)};return t._data=a(this._data,0),t._size=W.clone(this._size),t},r.prototype.forEach=function(e){var n=this,t=[],r=function(i,a){i instanceof Array?i.forEach(function(e,n){t[a]=n+1,r(e,a+1)}):e(i,t,n)};r(this._data,0)},r.prototype.toScalar=function(){for(var e=this._data;e instanceof Array&&1==e.length;)e=e[0];return e instanceof Array?null:W.clone(e)},r.prototype.isScalar=function(){return this._size.every(function(e){return 1>=e})},r.prototype.toVector=function(){var e=0,n=void 0,t=[];if(this._size.forEach(function(r,i){r>1&&(e++,n=i),t[i]=0}),0==e){var r=this.toScalar();return r?[r]:[]}if(1==e){var i=[],a=function(e){e instanceof Array?e.forEach(a):i.push(e)};return a(this._data),i}return null},r.prototype.isVector=function(){var e=0;return this._size.forEach(function(n){n>1&&e++}),1>=e},r.prototype.toArray=function(){return W.clone(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.toString=function(){return Z.formatArray(this._data)},W.type.Range=d,d.parse=function(e){if(!y(e))return null;var n=e.split(":"),t=n.map(function(e){return Number(e)}),r=t.some(function(e){return isNaN(e)});if(r)return null;switch(t.length){case 2:return new d(t[0],1,t[1]);case 3:return new d(t[0],t[1],t[2]);default:return null}},d.prototype.clone=function(){return new d(this.start,this.step,this.end)},d.prototype.size=function(){var e=0,n=Number(this.start),t=Number(this.step),r=Number(this.end),i=r-n;return W.sign(t)==W.sign(i)?e=Math.floor(i/t)+1:0==i&&(e=1),isNaN(e)&&(e=0),[e]},d.prototype.forEach=function(e){var n=Number(this.start),t=Number(this.step),r=Number(this.end),i=0;if(t>0)for(;r>=n;)e(n,i,this),n+=t,i++;else if(0>t)for(;n>=r;)e(n,i,this),n+=t,i++},d.prototype.map=function(e){var n=[];return this.forEach(function(t,r,i){n[r]=e(t,r,i)}),n},d.prototype.toMatrix=function(){return new r(this.toArray())},d.prototype.toArray=function(){var e=[];return this.forEach(function(n,t){e[t]=n}),e},d.prototype.toVector=d.prototype.toArray,d.prototype.isVector=function(){return!0},d.prototype.toScalar=function(){var e=this.toArray();return 1==e.length?e[0]:null},d.prototype.isScalar=function(){return 1==this.size()[0]},d.prototype.valueOf=function(){return this.toArray()},d.prototype.toString=function(){var e=W.format(Number(this.start));return 1!=this.step&&(e+=":"+W.format(Number(this.step))),e+=":"+W.format(Number(this.end))},W.type.Unit=E,function(){function e(){for(;" "==u||"	"==u;)r()}function n(e){return e>="0"&&"9">=e||"."==e}function t(e){return e>="0"&&"9">=e}function r(){s++,u=f[s]}function i(e){s=e,u=f[s]}function a(){var e="",a=s;if("+"==u?r():"-"==u&&(e+=u,r()),!n(u))return i(a),null;for(;n(u);)e+=u,r();if("E"==u||"e"==u){if(e+=u,r(),("+"==u||"-"==u)&&(e+=u,r()),!t(u))return i(a),null;for(;t(u);)e+=u,r()}return e}function o(){var n="";for(e();u&&" "!=u&&"	"!=u;)n+=u,r();return n||null}var f,s,u;E.parse=function(n){if(f=n,s=-1,u="",!y(f))return null;r(),e();var t,i=a();return i?(t=o(),r(),e(),u?null:i&&t?new E(Number(i),t):null):(t=o(),r(),e(),u?null:new E(null,t))}}(),E.prototype.clone=function(){var e=new E;for(var n in this)this.hasOwnProperty(n)&&(e[n]=this[n]);return e},E.prototype._normalize=function(e){return(e+this.unit.offset)*this.unit.value*this.prefix.value},E.prototype._unnormalize=function(e,n){return void 0==n?e/this.unit.value/this.prefix.value-this.unit.offset:e/this.unit.value/n-this.unit.offset},E.isPlainUnit=function(e){return null!=N(e)},E.prototype.hasBase=function(e){return void 0===this.unit.base?void 0===e:this.unit.base===e},E.prototype.equalBase=function(e){return this.unit.base===e.unit.base},E.prototype.equals=function(e){return this.equalBase(e)&&this.value==e.value},E.prototype.in=function(e){var n;if(y(e)){if(n=new E(null,e),!this.equalBase(n))throw Error("Units do not match");return n.value=this.value,n}if(e instanceof E){if(!this.equalBase(e))throw Error("Units do not match");if(e.hasValue)throw Error("Cannot convert to a unit with a value");if(!e.hasUnit)throw Error("Unit expected on the right hand side of function in");return n=e.clone(),n.value=this.value,n.fixPrefix=!0,n}throw Error("String or Unit expected as parameter")},E.prototype.toNumber=function(e){var n=this.in(e),t=this.fixPrefix?n._bestPrefix():n.prefix;return n._unnormalize(n.value,t.value)},E.prototype.toString=function(){var e;if(this.fixPrefix)return e=this._unnormalize(this.value),Z.formatNumber(e)+" "+this.prefix.name+this.unit.name;var n=this._bestPrefix();return e=this._unnormalize(this.value,n.value),Z.formatNumber(e)+" "+n.name+this.unit.name},E.prototype._bestPrefix=function(){var e=Math.abs(this.value/this.unit.value),n=E.PREFIX_NONE,t=Math.abs(Math.log(e/n.value)/Math.LN10-1.2),r=this.unit.prefixes;for(var i in r)if(r.hasOwnProperty(i)){var a=r[i];if(a.scientific){var o=Math.abs(Math.log(e/a.value)/Math.LN10-1.2);t>o&&(n=a,t=o)}}return n},E.PREFIXES={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0}},BINARY_SHORT:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1024,scientific:!0},M:{name:"M",value:Math.pow(1024,2),scientific:!0},G:{name:"G",value:Math.pow(1024,3),scientific:!0},T:{name:"T",value:Math.pow(1024,4),scientific:!0},P:{name:"P",value:Math.pow(1024,5),scientific:!0},E:{name:"E",value:Math.pow(1024,6),scientific:!0},Z:{name:"Z",value:Math.pow(1024,7),scientific:!0},Y:{name:"Y",value:Math.pow(1024,8),scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1024,scientific:!0},mega:{name:"mega",value:Math.pow(1024,2),scientific:!0},giga:{name:"giga",value:Math.pow(1024,3),scientific:!0},tera:{name:"tera",value:Math.pow(1024,4),scientific:!0},peta:{name:"peta",value:Math.pow(1024,5),scientific:!0},exa:{name:"exa",value:Math.pow(1024,6),scientific:!0},zetta:{name:"zetta",value:Math.pow(1024,7),scientific:!0},yotta:{name:"yotta",value:Math.pow(1024,8),scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}}},E.PREFIX_NONE={name:"",value:1,scientific:!0},E.BASE_UNITS={NONE:{},LENGTH:{},MASS:{},TIME:{},CURRENT:{},TEMPERATURE:{},LUMINOUS_INTENSITY:{},AMOUNT_OF_SUBSTANCE:{},FORCE:{},SURFACE:{},VOLUME:{},ANGLE:{},BIT:{}};var X=E.BASE_UNITS,Q=E.PREFIXES;E.BASE_UNIT_NONE={},E.UNIT_NONE={name:"",base:E.BASE_UNIT_NONE,value:1,offset:0},E.UNITS=[{name:"meter",base:X.LENGTH,prefixes:Q.LONG,value:1,offset:0},{name:"inch",base:X.LENGTH,prefixes:Q.NONE,value:.0254,offset:0},{name:"foot",base:X.LENGTH,prefixes:Q.NONE,value:.3048,offset:0},{name:"yard",base:X.LENGTH,prefixes:Q.NONE,value:.9144,offset:0},{name:"mile",base:X.LENGTH,prefixes:Q.NONE,value:1609.344,offset:0},{name:"link",base:X.LENGTH,prefixes:Q.NONE,value:.201168,offset:0},{name:"rod",base:X.LENGTH,prefixes:Q.NONE,value:5.02921,offset:0},{name:"chain",base:X.LENGTH,prefixes:Q.NONE,value:20.1168,offset:0},{name:"angstrom",base:X.LENGTH,prefixes:Q.NONE,value:1e-10,offset:0},{name:"m",base:X.LENGTH,prefixes:Q.SHORT,value:1,offset:0},{name:"ft",base:X.LENGTH,prefixes:Q.NONE,value:.3048,offset:0},{name:"yd",base:X.LENGTH,prefixes:Q.NONE,value:.9144,offset:0},{name:"mi",base:X.LENGTH,prefixes:Q.NONE,value:1609.344,offset:0},{name:"li",base:X.LENGTH,prefixes:Q.NONE,value:.201168,offset:0},{name:"rd",base:X.LENGTH,prefixes:Q.NONE,value:5.02921,offset:0},{name:"ch",base:X.LENGTH,prefixes:Q.NONE,value:20.1168,offset:0},{name:"mil",base:X.LENGTH,prefixes:Q.NONE,value:254e-7,offset:0},{name:"m2",base:X.SURFACE,prefixes:Q.SHORT,value:1,offset:0},{name:"sqin",base:X.SURFACE,prefixes:Q.NONE,value:64516e-8,offset:0},{name:"sqft",base:X.SURFACE,prefixes:Q.NONE,value:.09290304,offset:0},{name:"sqyd",base:X.SURFACE,prefixes:Q.NONE,value:.83612736,offset:0},{name:"sqmi",base:X.SURFACE,prefixes:Q.NONE,value:2589988.110336,offset:0},{name:"sqrd",base:X.SURFACE,prefixes:Q.NONE,value:25.29295,offset:0},{name:"sqch",base:X.SURFACE,prefixes:Q.NONE,value:404.6873,offset:0},{name:"sqmil",base:X.SURFACE,prefixes:Q.NONE,value:6.4516e-10,offset:0},{name:"m3",base:X.VOLUME,prefixes:Q.SHORT,value:1,offset:0},{name:"L",base:X.VOLUME,prefixes:Q.SHORT,value:.001,offset:0},{name:"litre",base:X.VOLUME,prefixes:Q.LONG,value:.001,offset:0},{name:"cuin",base:X.VOLUME,prefixes:Q.NONE,value:16387064e-12,offset:0},{name:"cuft",base:X.VOLUME,prefixes:Q.NONE,value:.028316846592,offset:0},{name:"cuyd",base:X.VOLUME,prefixes:Q.NONE,value:.764554857984,offset:0},{name:"teaspoon",base:X.VOLUME,prefixes:Q.NONE,value:5e-6,offset:0},{name:"tablespoon",base:X.VOLUME,prefixes:Q.NONE,value:15e-6,offset:0},{name:"minim",base:X.VOLUME,prefixes:Q.NONE,value:6.161152e-8,offset:0},{name:"fluiddram",base:X.VOLUME,prefixes:Q.NONE,value:36966911e-13,offset:0},{name:"fluidounce",base:X.VOLUME,prefixes:Q.NONE,value:2957353e-11,offset:0},{name:"gill",base:X.VOLUME,prefixes:Q.NONE,value:.0001182941,offset:0},{name:"cup",base:X.VOLUME,prefixes:Q.NONE,value:.0002365882,offset:0},{name:"pint",base:X.VOLUME,prefixes:Q.NONE,value:.0004731765,offset:0},{name:"quart",base:X.VOLUME,prefixes:Q.NONE,value:.0009463529,offset:0},{name:"gallon",base:X.VOLUME,prefixes:Q.NONE,value:.003785412,offset:0},{name:"beerbarrel",base:X.VOLUME,prefixes:Q.NONE,value:.1173478,offset:0},{name:"oilbarrel",base:X.VOLUME,prefixes:Q.NONE,value:.1589873,offset:0},{name:"hogshead",base:X.VOLUME,prefixes:Q.NONE,value:.238481,offset:0},{name:"fldr",base:X.VOLUME,prefixes:Q.NONE,value:36966911e-13,offset:0},{name:"floz",base:X.VOLUME,prefixes:Q.NONE,value:2957353e-11,offset:0},{name:"gi",base:X.VOLUME,prefixes:Q.NONE,value:.0001182941,offset:0},{name:"cp",base:X.VOLUME,prefixes:Q.NONE,value:.0002365882,offset:0},{name:"pt",base:X.VOLUME,prefixes:Q.NONE,value:.0004731765,offset:0},{name:"qt",base:X.VOLUME,prefixes:Q.NONE,value:.0009463529,offset:0},{name:"gal",base:X.VOLUME,prefixes:Q.NONE,value:.003785412,offset:0},{name:"bbl",base:X.VOLUME,prefixes:Q.NONE,value:.1173478,offset:0},{name:"obl",base:X.VOLUME,prefixes:Q.NONE,value:.1589873,offset:0},{name:"g",base:X.MASS,prefixes:Q.SHORT,value:.001,offset:0},{name:"gram",base:X.MASS,prefixes:Q.LONG,value:.001,offset:0},{name:"ton",base:X.MASS,prefixes:Q.SHORT,value:907.18474,offset:0},{name:"tonne",base:X.MASS,prefixes:Q.SHORT,value:1e3,offset:0},{name:"grain",base:X.MASS,prefixes:Q.NONE,value:6479891e-11,offset:0},{name:"dram",base:X.MASS,prefixes:Q.NONE,value:.0017718451953125,offset:0},{name:"ounce",base:X.MASS,prefixes:Q.NONE,value:.028349523125,offset:0},{name:"poundmass",base:X.MASS,prefixes:Q.NONE,value:.45359237,offset:0},{name:"hundredweight",base:X.MASS,prefixes:Q.NONE,value:45.359237,offset:0},{name:"stick",base:X.MASS,prefixes:Q.NONE,value:.115,offset:0},{name:"gr",base:X.MASS,prefixes:Q.NONE,value:6479891e-11,offset:0},{name:"dr",base:X.MASS,prefixes:Q.NONE,value:.0017718451953125,offset:0},{name:"oz",base:X.MASS,prefixes:Q.NONE,value:.028349523125,offset:0},{name:"lbm",base:X.MASS,prefixes:Q.NONE,value:.45359237,offset:0},{name:"cwt",base:X.MASS,prefixes:Q.NONE,value:45.359237,offset:0},{name:"s",base:X.TIME,prefixes:Q.SHORT,value:1,offset:0},{name:"min",base:X.TIME,prefixes:Q.NONE,value:60,offset:0},{name:"h",base:X.TIME,prefixes:Q.NONE,value:3600,offset:0},{name:"seconds",base:X.TIME,prefixes:Q.LONG,value:1,offset:0},{name:"second",base:X.TIME,prefixes:Q.LONG,value:1,offset:0},{name:"sec",base:X.TIME,prefixes:Q.LONG,value:1,offset:0},{name:"minutes",base:X.TIME,prefixes:Q.NONE,value:60,offset:0},{name:"minute",base:X.TIME,prefixes:Q.NONE,value:60,offset:0},{name:"hours",base:X.TIME,prefixes:Q.NONE,value:3600,offset:0},{name:"hour",base:X.TIME,prefixes:Q.NONE,value:3600,offset:0},{name:"day",base:X.TIME,prefixes:Q.NONE,value:86400,offset:0},{name:"days",base:X.TIME,prefixes:Q.NONE,value:86400,offset:0},{name:"rad",base:X.ANGLE,prefixes:Q.NONE,value:1,offset:0},{name:"deg",base:X.ANGLE,prefixes:Q.NONE,value:.017453292519943295,offset:0},{name:"grad",base:X.ANGLE,prefixes:Q.NONE,value:.015707963267948967,offset:0},{name:"cycle",base:X.ANGLE,prefixes:Q.NONE,value:6.283185307179586,offset:0},{name:"A",base:X.CURRENT,prefixes:Q.SHORT,value:1,offset:0},{name:"ampere",base:X.CURRENT,prefixes:Q.LONG,value:1,offset:0},{name:"K",base:X.TEMPERATURE,prefixes:Q.NONE,value:1,offset:0},{name:"degC",base:X.TEMPERATURE,prefixes:Q.NONE,value:1,offset:273.15},{name:"degF",base:X.TEMPERATURE,prefixes:Q.NONE,value:1/1.8,offset:459.67},{name:"degR",base:X.TEMPERATURE,prefixes:Q.NONE,value:1/1.8,offset:0},{name:"kelvin",base:X.TEMPERATURE,prefixes:Q.NONE,value:1,offset:0},{name:"celsius",base:X.TEMPERATURE,prefixes:Q.NONE,value:1,offset:273.15},{name:"fahrenheit",base:X.TEMPERATURE,prefixes:Q.NONE,value:1/1.8,offset:459.67},{name:"rankine",base:X.TEMPERATURE,prefixes:Q.NONE,value:1/1.8,offset:0},{name:"mol",base:X.AMOUNT_OF_SUBSTANCE,prefixes:Q.NONE,value:1,offset:0},{name:"mole",base:X.AMOUNT_OF_SUBSTANCE,prefixes:Q.NONE,value:1,offset:0},{name:"cd",base:X.LUMINOUS_INTENSITY,prefixes:Q.NONE,value:1,offset:0},{name:"candela",base:X.LUMINOUS_INTENSITY,prefixes:Q.NONE,value:1,offset:0},{name:"N",base:X.FORCE,prefixes:Q.SHORT,value:1,offset:0},{name:"newton",base:X.FORCE,prefixes:Q.LONG,value:1,offset:0},{name:"lbf",base:X.FORCE,prefixes:Q.NONE,value:4.4482216152605,offset:0},{name:"poundforce",base:X.FORCE,prefixes:Q.NONE,value:4.4482216152605,offset:0},{name:"b",base:X.BIT,prefixes:Q.BINARY_SHORT,value:1,offset:0},{name:"bits",base:X.BIT,prefixes:Q.BINARY_LONG,value:1,offset:0},{name:"B",base:X.BIT,prefixes:Q.BINARY_SHORT,value:8,offset:0},{name:"bytes",base:X.BIT,prefixes:Q.BINARY_LONG,value:8,offset:0}],W.E=Math.E,W.LN2=Math.LN2,W.LN10=Math.LN10,W.LOG2E=Math.LOG2E,W.LOG10E=Math.LOG10E,W.PI=Math.PI,W.SQRT1_2=Math.SQRT1_2,W.SQRT2=Math.SQRT2,W.I=new t(0,1),W.pi=W.PI,W.e=W.E,W.i=W.I,W.abs=function(e){if(1!=arguments.length)throw x("abs",arguments.length,1);
if(g(e))return Math.abs(e);if(e instanceof t)return Math.sqrt(e.re*e.re+e.im*e.im);if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.abs);if(e.valueOf()!==e)return W.abs(e.valueOf());throw O("abs",e)},W.add=function(e,n){if(2!=arguments.length)throw x("add",arguments.length,2);if(g(e)){if(g(n))return e+n;if(n instanceof t)return new t(e+n.re,n.im)}else if(e instanceof t){if(g(n))return new t(e.re+n,e.im);if(n instanceof t)return new t(e.re+n.re,e.im+n.im)}else if(e instanceof E&&n instanceof E){if(!e.equalBase(n))throw Error("Units do not match");if(!e.hasValue)throw Error("Unit on left hand side of operator + has no value");if(!n.hasValue)throw Error("Unit on right hand side of operator + has no value");var i=e.clone();return i.value+=n.value,i.fixPrefix=!1,i}if(y(e)||y(n))return e+n;if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.add);if(e.valueOf()!==e)return W.add(e.valueOf(),n.valueOf());throw O("add",e,n)},W.ceil=function(e){if(1!=arguments.length)throw x("ceil",arguments.length,1);if(g(e))return Math.ceil(e);if(e instanceof t)return new t(Math.ceil(e.re),Math.ceil(e.im));if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.ceil);if(e.valueOf()!==e)return W.ceil(e.valueOf());throw O("ceil",e)},W.cube=function(e){if(1!=arguments.length)throw x("cube",arguments.length,1);if(g(e))return e*e*e;if(e instanceof t)return W.multiply(W.multiply(e,e),e);if(e instanceof Array||e instanceof r||e instanceof d)return W.multiply(W.multiply(e,e),e);if(e.valueOf()!==e)return W.cube(e.valueOf());throw O("cube",e)},W.divide=function(e,n){if(2!=arguments.length)throw x("divide",arguments.length,2);if(g(e)){if(g(n))return e/n;if(n instanceof t)return b(new t(e,0),n)}if(e instanceof t){if(g(n))return b(e,new t(n,0));if(n instanceof t)return b(e,n)}if(e instanceof E&&g(n)){var i=e.clone();return i.value/=n,i}if(e instanceof Array||e instanceof r)return n instanceof Array||n instanceof r?W.multiply(e,W.inv(n)):Z.map2(e,n,W.divide);if(n instanceof Array||n instanceof r)return W.multiply(e,W.inv(n));if(e.valueOf()!==e||n.valueOf()!==n)return W.divide(e.valueOf(),n.valueOf());throw O("divide",e,n)},W.equal=function J(e,n){if(2!=arguments.length)throw x("equal",arguments.length,2);if(g(e)){if(g(n))return e==n;if(n instanceof t)return e==n.re&&0==n.im}if(e instanceof t){if(g(n))return e.re==n&&0==e.im;if(n instanceof t)return e.re==n.re&&e.im==n.im}if(e instanceof E&&n instanceof E){if(!e.equalBase(n))throw Error("Cannot compare units with different base");return e.value==n.value}if(y(e)||y(n))return e==n;if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.equal);if(e.valueOf()!==e||n.valueOf()!==n)return J(e.valueOf(),n.valueOf());throw O("equal",e,n)},W.exp=function(e){if(1!=arguments.length)throw x("exp",arguments.length,1);if(g(e))return Math.exp(e);if(e instanceof t){var n=Math.exp(e.re);return new t(n*Math.cos(e.im),n*Math.sin(e.im))}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.exp);if(e.valueOf()!==e)return W.exp(e.valueOf());throw O("exp",e)},W.fix=function(e){if(1!=arguments.length)throw x("fix",arguments.length,1);if(g(e))return e>0?Math.floor(e):Math.ceil(e);if(e instanceof t)return new t(e.re>0?Math.floor(e.re):Math.ceil(e.re),e.im>0?Math.floor(e.im):Math.ceil(e.im));if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.fix);if(e.valueOf()!==e)return W.fix(e.valueOf());throw O("fix",e)},W.floor=function(e){if(1!=arguments.length)throw x("floor",arguments.length,1);if(g(e))return Math.floor(e);if(e instanceof t)return new t(Math.floor(e.re),Math.floor(e.im));if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.floor);if(e.valueOf()!==e)return W.floor(e.valueOf());throw O("floor",e)},W.gcd=function(){var e,n=arguments[0],t=arguments[1];if(2==arguments.length){if(g(n)&&g(t)){if(!w(n)||!w(t))throw Error("Parameters in function gcd must be integer numbers");for(;0!=t;)e=t,t=n%e,n=e;return Math.abs(n)}if(n instanceof Array||n instanceof r||t instanceof Array||t instanceof r)return Z.map2(n,t,W.gcd);if(n.valueOf()!==n||t.valueOf()!==t)return W.gcd(n.valueOf(),t.valueOf());throw O("gcd",n,t)}if(arguments.length>2){for(var i=1;arguments.length>i;i++)n=W.gcd(n,arguments[i]);return n}throw new SyntaxError("Function gcd expects two or more arguments")},W.larger=function(e,n){if(2!=arguments.length)throw x("larger",arguments.length,2);if(g(e)){if(g(n))return e>n;if(n instanceof t)return e>W.abs(n)}if(e instanceof t){if(g(n))return W.abs(e)>n;if(n instanceof t)return W.abs(e)>W.abs(n)}if(e instanceof E&&n instanceof E){if(!e.equalBase(n))throw Error("Cannot compare units with different base");return e.value>n.value}if(y(e)||y(n))return e>n;if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.larger);if(e.valueOf()!==e||n.valueOf()!==n)return W.larger(e.valueOf(),n.valueOf());throw O("larger",e,n)},W.largereq=function(e,n){if(2!=arguments.length)throw x("largereq",arguments.length,2);if(g(e)){if(g(n))return e>=n;if(n instanceof t)return e>=W.abs(n)}if(e instanceof t){if(g(n))return W.abs(e)>=n;if(n instanceof t)return W.abs(e)>=W.abs(n)}if(e instanceof E&&n instanceof E){if(!e.equalBase(n))throw Error("Cannot compare units with different base");return e.value>=n.value}if(y(e)||y(n))return e>=n;if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.largereq);if(e.valueOf()!==e||n.valueOf()!==n)return W.largereq(e.valueOf(),n.valueOf());throw O("largereq",e,n)},W.lcm=function(){var e,n=arguments[0],t=arguments[1];if(2==arguments.length){if(g(n)&&g(t)){if(!w(n)||!w(t))throw Error("Parameters in function lcm must be integer numbers");for(var i=n*t;0!=t;)e=t,t=n%e,n=e;return Math.abs(i/n)}if(n instanceof Array||n instanceof r||t instanceof Array||t instanceof r)return Z.map2(n,t,W.lcm);if(n.valueOf()!==n||t.valueOf()!==t)return W.lcm(n.valueOf(),t.valueOf());throw O("lcm",n,t)}if(arguments.length>2){for(var a=1;arguments.length>a;a++)n=W.lcm(n,arguments[a]);return n}throw new SyntaxError("Function lcm expects two or more arguments")},W.log=function(e,n){if(1!=arguments.length&&2!=arguments.length)throw x("log",arguments.length,1,2);if(void 0!==n)return W.divide(W.log(e),W.log(n));if(g(e))return e>=0?Math.log(e):W.log(new t(e,0));if(e instanceof t)return new t(Math.log(Math.sqrt(e.re*e.re+e.im*e.im)),Math.atan2(e.im,e.re));if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.log);if(e.valueOf()!==e||n.valueOf()!==n)return W.log(e.valueOf(),n.valueOf());throw O("log",e,n)},W.log10=function(e){if(1!=arguments.length)throw x("log10",arguments.length,1);if(g(e))return e>=0?Math.log(e)/Math.LN10:W.log10(new t(e,0));if(e instanceof t)return new t(Math.log(Math.sqrt(e.re*e.re+e.im*e.im))/Math.LN10,Math.atan2(e.im,e.re)/Math.LN10);if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.log10);if(e.valueOf()!==e)return W.log10(e.valueOf());throw O("log10",e)},W.mod=function(e,n){if(2!=arguments.length)throw x("mod",arguments.length,2);if(g(e)){if(g(n))return e%n;if(n instanceof t&&0==n.im)return e%n.re}else if(e instanceof t&&0==e.im){if(g(n))return e.re%n;if(n instanceof t&&0==n.im)return e.re%n.re}if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.mod);if(e.valueOf()!==e||n.valueOf()!==n)return W.mod(e.valueOf(),n.valueOf());throw O("mod",e,n)},W.multiply=function(e,n){if(2!=arguments.length)throw x("multiply",arguments.length,2);if(g(e)){if(g(n))return e*n;if(n instanceof t)return M(new t(e,0),n);if(n instanceof E)return o=n.clone(),o.value*=e,o}else if(e instanceof t){if(g(n))return M(e,new t(n,0));if(n instanceof t)return M(e,n)}else if(e instanceof E){if(g(n))return o=e.clone(),o.value*=n,o}else{if(e instanceof Array){if(n instanceof Array){var i=Z.size(e),a=Z.size(n);if(2!=i.length)throw Error("Can only multiply a 2 dimensional matrix (A has "+i.length+" dimensions)");if(2!=a.length)throw Error("Can only multiply a 2 dimensional matrix (B has "+a.length+" dimensions)");if(i[1]!=a[0])throw new RangeError("Dimensions mismatch in multiplication. Columns of A must match rows of B (A is "+i[0]+"x"+i[1]+", B is "+a[0]+"x"+a[1]+", "+a[1]+" != "+a[0]+")");for(var o=[],f=i[0],s=a[1],u=i[1],c=W.multiply,l=W.add,h=0;f>h;h++){o[h]=[];for(var m=0;s>m;m++){for(var p=null,v=0;u>v;v++){var w=c(e[h][v],n[v][m]);p=null==p?w:l(p,w)}o[h][m]=p}}return o}return n instanceof r?new r(W.multiply(e.valueOf(),n.valueOf())):Z.map2(e,n,W.multiply)}if(e instanceof r)return new r(W.multiply(e.valueOf(),n.valueOf()))}if(n instanceof Array)return Z.map2(e,n,W.multiply);if(n instanceof r)return new r(W.multiply(e.valueOf(),n.valueOf()));if(e.valueOf()!==e||n.valueOf()!==n)return W.multiply(e.valueOf(),n.valueOf());throw O("multiply",e,n)},W.pow=function(e,n){if(2!=arguments.length)throw x("pow",arguments.length,2);if(g(e)){if(g(n))return w(n)||e>=0?Math.pow(e,n):A(new t(e,0),new t(n,0));if(n instanceof t)return A(new t(e,0),n)}else if(e instanceof t){if(g(n))return A(e,new t(n,0));if(n instanceof t)return A(e,n)}else{if(e instanceof Array){if(!g(n)||!w(n)||0>n)throw new TypeError("For A^b, b must be a positive integer (value is "+n+")");var i=Z.size(e);if(2!=i.length)throw Error("For A^b, A must be 2 dimensional (A has "+i.length+" dimensions)");if(i[0]!=i[1])throw Error("For A^b, A must be square (size is "+i[0]+"x"+i[1]+")");if(0==n)return W.eye(i[0]);for(var a=e,o=1;n>o;o++)a=W.multiply(e,a);return a}if(e instanceof r)return new r(W.pow(e.valueOf(),n))}if(e.valueOf()!==e||n.valueOf()!==n)return W.pow(e.valueOf(),n.valueOf());throw O("pow",e,n)},W.round=function(e,n){if(1!=arguments.length&&2!=arguments.length)throw x("round",arguments.length,1,2);if(void 0==n){if(g(e))return Math.round(e);if(e instanceof t)return new t(Math.round(e.re),Math.round(e.im));if((e instanceof Array||e instanceof r||e instanceof d)&&Z.map(e,W.round),e.valueOf()!==e)return W.round(e.valueOf());throw O("round",e)}if(!g(n))throw new TypeError("Number of digits in function round must be an integer");if(n!==Math.round(n))throw new TypeError("Number of digits in function round must be integer");if(0>n||n>9)throw Error("Number of digits in function round must be in te range of 0-9");if(g(e))return S(e,n);if(e instanceof t)return new t(S(e.re,n),S(e.im,n));if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.round);if(e.valueOf()!==e||n.valueOf()!==n)return W.round(e.valueOf(),n.valueOf());throw O("round",e,n)},W.sign=function(e){if(1!=arguments.length)throw x("sign",arguments.length,1);if(g(e)){var n;return n=e>0?1:0>e?-1:0}if(e instanceof t){var i=Math.sqrt(e.re*e.re+e.im*e.im);return new t(e.re/i,e.im/i)}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.sign);if(e.valueOf()!==e)return W.sign(e.valueOf());throw O("sign",e)},W.smaller=function(e,n){if(2!=arguments.length)throw x("smaller",arguments.length,2);if(g(e)){if(g(n))return n>e;if(n instanceof t)return W.abs(n)>e}if(e instanceof t){if(g(n))return n>W.abs(e);if(n instanceof t)return W.abs(e)<W.abs(n)}if(e instanceof E&&n instanceof E){if(!e.equalBase(n))throw Error("Cannot compare units with different base");return e.value<n.value}if(y(e)||y(n))return n>e;if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.smaller);if(e.valueOf()!==e||n.valueOf()!==n)return W.smaller(e.valueOf(),n.valueOf());throw O("smaller",e,n)},W.smallereq=function(e,n){if(2!=arguments.length)throw x("smallereq",arguments.length,2);if(g(e)){if(g(n))return n>=e;if(n instanceof t)return W.abs(n)>=e}if(e instanceof t){if(g(n))return n>=W.abs(e);if(n instanceof t)return W.abs(e)<=W.abs(n)}if(e instanceof E&&n instanceof E){if(!e.equalBase(n))throw Error("Cannot compare units with different base");return e.value<=n.value}if(y(e)||y(n))return n>=e;if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.smallereq);if(e.valueOf()!==e||n.valueOf()!==n)return W.smallereq(e.valueOf(),n.valueOf());throw O("smallereq",e,n)},W.sqrt=function(e){if(1!=arguments.length)throw x("sqrt",arguments.length,1);if(g(e))return e>=0?Math.sqrt(e):W.sqrt(new t(e,0));if(e instanceof t){var n=Math.sqrt(e.re*e.re+e.im*e.im);return e.im>=0?new t(.5*Math.sqrt(2*(n+e.re)),.5*Math.sqrt(2*(n-e.re))):new t(.5*Math.sqrt(2*(n+e.re)),-.5*Math.sqrt(2*(n-e.re)))}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.sqrt);if(e.valueOf()!==e)return W.sqrt(e.valueOf());throw O("sqrt",e)},W.square=function(e){if(1!=arguments.length)throw x("square",arguments.length,1);if(g(e))return e*e;if(e instanceof t)return W.multiply(e,e);if(e instanceof Array||e instanceof r||e instanceof d)return W.multiply(e,e);if(e.valueOf()!==e)return W.square(e.valueOf());throw O("square",e)},W.subtract=function(e,n){if(2!=arguments.length)throw x("subtract",arguments.length,2);if(g(e)){if(g(n))return e-n;if(n instanceof t)return new t(e-n.re,n.im)}else if(e instanceof t){if(g(n))return new t(e.re-n,e.im);if(n instanceof t)return new t(e.re-n.re,e.im-n.im)}else if(e instanceof E&&n instanceof E){if(!e.equalBase(n))throw Error("Units do not match");if(!e.hasValue)throw Error("Unit on left hand side of operator - has no value");if(!n.hasValue)throw Error("Unit on right hand side of operator - has no value");var i=e.clone();return i.value-=n.value,i.fixPrefix=!1,i}if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.subtract);if(e.valueOf()!==e||n.valueOf()!==n)return W.subtract(e.valueOf(),n.valueOf());throw O("subtract",e,n)},W.unaryminus=function(e){if(1!=arguments.length)throw x("unaryminus",arguments.length,1);if(g(e))return-e;if(e instanceof t)return new t(-e.re,-e.im);if(e instanceof E){var n=e.clone();return n.value=-e.value,n}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.unaryminus);if(e.valueOf()!==e)return W.unaryminus(e.valueOf());throw O("unaryminus",e)},W.unequal=function(e,n){if(2!=arguments.length)throw x("unequal",arguments.length,2);if(g(e)){if(g(n))return e==n;if(n instanceof t)return e==n.re&&0==n.im}if(e instanceof t){if(g(n))return e.re==n&&0==e.im;if(n instanceof t)return e.re==n.re&&e.im==n.im}if(e instanceof E&&n instanceof E){if(!e.equalBase(n))throw Error("Cannot compare units with different base");return e.value==n.value}if(y(e)||y(n))return e==n;if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.unequal);if(e.valueOf()!==e||n.valueOf()!==n)return W.unequal(e.valueOf(),n.valueOf());throw O("unequal",e,n)},W.arg=function(e){if(1!=arguments.length)throw x("arg",arguments.length,1);if(g(e))return Math.atan2(0,e);if(e instanceof t)return Math.atan2(e.im,e.re);if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.arg);if(e.valueOf()!==e)return W.arg(e.valueOf());throw O("arg",e)},W.conj=function(e){if(1!=arguments.length)throw x("conj",arguments.length,1);if(g(e))return e;if(e instanceof t)return new t(e.re,-e.im);if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.conj);if(e.valueOf()!==e)return W.conj(e.valueOf());throw O("conj",e)},W.im=function(e){if(1!=arguments.length)throw x("im",arguments.length,1);if(g(e))return 0;if(e instanceof t)return e.im;if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.im);if(e.valueOf()!==e)return W.im(e.valueOf());throw O("im",e)},W.re=function(e){if(1!=arguments.length)throw x("re",arguments.length,1);if(g(e))return e;if(e instanceof t)return e.re;if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.re);if(e.valueOf()!==e)return W.re(e.valueOf());throw O("re",e)},W.complex=function(){switch(arguments.length){case 0:return new t(0,0);case 1:var e=arguments[0];if(!y(e))throw new TypeError("Two numbers or a single string expected in function complex");var n=t.parse(e);if(n)return n;throw new SyntaxError('String "'+e+'" is no valid complex number');case 2:return new t(arguments[0],arguments[1]);default:throw x("complex",arguments.length,0,2)}},W.matrix=function(e){if(arguments.length>1)throw x("matrix",arguments.length,0,1);return new r(e)},W.parser=function(){return new W.expr.Parser},W.range=function(e){switch(arguments.length){case 1:if(!y(e))throw new TypeError("Two or three numbers or a single string expected in function range");var n=d.parse(e);if(n)return n;throw new SyntaxError('String "'+n+'" is no valid range');case 2:return new d(arguments[0],null,arguments[1]);case 3:return new d(arguments[0],arguments[1],arguments[2]);default:throw x("range",arguments.length,2,3)}},W.unit=function(){switch(arguments.length){case 1:var e=arguments[0];if(!y(e))throw new TypeError("A string or a number and string expected in function unit");if(E.isPlainUnit(e))return new E(null,e);var n=E.parse(e);if(n)return n;throw new SyntaxError('String "'+e+'" is no valid unit');case 2:return new E(arguments[0],arguments[1]);default:throw x("unit",arguments.length,1,2)}},W.workspace=function(){return new W.expr.Workspace},W.concat=function(){var e,n,t=arguments.length,i=-1,a=!1,o=[];for(e=0;t>e;e++){var f=arguments[e];if(f instanceof r&&(a=!0),e==t-1&&g(f)){if(n=i,i=f,!w(i)||1>i)throw new TypeError("Dimension number must be a positive integer (dim = "+i+")");if(e>0&&i>n)throw new RangeError("Dimension out of range ("+i+" > "+n+")")}else{if(!(f instanceof Array||f instanceof r))throw O("concat",f);var s=W.clone(f.valueOf()),u=W.size(f);if(o[e]=s,n=i,i=u.length,e>0&&i!=n)throw new RangeError("Dimension mismatch ("+n+" != "+i+")")}}if(0==o.length)throw new SyntaxError("At least one matrix expected");for(var c=o.shift();o.length;)c=T(c,o.shift(),i-1,0);return a?new r(c):c},W.det=function(e){if(1!=arguments.length)throw x("det",arguments.length,1);var n=W.size(e);switch(n.length){case 0:return W.clone(e);case 1:if(1==n[0])return W.clone(e.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+W.format(n)+")");case 2:var t=n[0],r=n[1];if(t==r)return U(e.valueOf(),t,r);throw new RangeError("Matrix must be square (size: "+W.format(n)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+W.format(n)+")")}},W.diag=function(e,n){var t,i,a,o;if(1!=arguments.length&&2!=arguments.length)throw x("diag",arguments.length,1,2);if(n){if(!g(n)||!w(n))throw new TypeError("Second parameter in function diag must be an integer")}else n=0;var f=n>0?n:0,s=0>n?-n:0;e instanceof r||e instanceof d||(e=new r(e));var u;switch(e.isVector()?(e=e.toVector(),u=[e.length]):u=e.size(),u.length){case 1:i=e.valueOf();var c=new r;for(c.resize([i.length+s,i.length+f]),t=c.valueOf(),o=i.length,a=0;o>a;a++)t[a+s][a+f]=W.clone(i[a]);return c;case 2:for(i=[],t=e.valueOf(),o=Math.min(u[0]-s,u[1]-f),a=0;o>a;a++)i[a]=W.clone(t[a+s][a+f]);return new r(i);default:throw new RangeError("Matrix for function diag must be 2 dimensional")}},W.eye=function(){var e=Z.argsToArray(arguments);if(0==e.length)e=[1,1];else if(1==e.length)e[1]=e[0];else if(e.length>2)throw x("eye",e.length,0,2);var n=e[0],t=e[1];if(!g(n)||!w(n)||1>n)throw Error("Parameters in function eye must be positive integers");if(t&&(!g(t)||!w(t)||1>t))throw Error("Parameters in function eye must be positive integers");var i=new r;i.resize(e);for(var a=W.min(e),o=i.valueOf(),f=0;a>f;f++)o[f][f]=1;return i},W.inv=function(e){if(1!=arguments.length)throw x("inv",arguments.length,1);var n=W.size(e);switch(n.length){case 0:return W.divide(1,e);case 1:if(1==n[0])return e instanceof r?new r([W.divide(1,e.valueOf()[0])]):[W.divide(1,e[0])];throw new RangeError("Matrix must be square (size: "+W.format(n)+")");case 2:var t=n[0],i=n[1];if(t==i)return e instanceof r?new r(R(e.valueOf(),t,i)):R(e,t,i);throw new RangeError("Matrix must be square (size: "+W.format(n)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+W.format(n)+")")}},W.ones=function(){var e=Z.argsToArray(arguments);0==e.length?e=[1,1]:1==e.length&&(e[1]=e[0]);var n=new r,t=1;return n.resize(e,t),n},W.size=function(e){if(1!=arguments.length)throw x("size",arguments.length,1);if(g(e)||e instanceof t||e instanceof E||null==e)return[];if(y(e))return[e.length];if(e instanceof Array)return Z.size(e);if(e instanceof r||e instanceof d)return e.size();if(e.valueOf()!==e)return W.size(e.valueOf());throw O("size",e)},W.squeeze=function(e){if(1!=arguments.length)throw x("squeeze",arguments.length,1);return e instanceof r||e instanceof d?_(e.toArray()):e instanceof Array?_(W.clone(e)):W.clone(e)},W.transpose=function(e){if(1!=arguments.length)throw x("transpose",arguments.length,1);var n=W.size(e);switch(n.length){case 0:return W.clone(e);case 1:return W.clone(e);case 2:for(var t,i=n[1],a=n[0],o=e instanceof r,f=e.valueOf(),s=[],u=W.clone,c=0;i>c;c++){t=s[c]=[];for(var l=0;a>l;l++)t[l]=u(f[l][c])}return 0==a&&(s[0]=[]),o?new r(s):s;default:throw new RangeError("Matrix must be two dimensional (size: "+W.format(n)+")")}},W.zeros=function(){var e=Z.argsToArray(arguments);0==e.length?e=[1,1]:1==e.length&&(e[1]=e[0]);var n=new r;return n.resize(e),n},W.factorial=function(e){if(1!=arguments.length)throw x("factorial",arguments.length,1);if(g(e)){if(!w(e))throw new TypeError("Function factorial can only handle integer values");var n=e,t=n;for(n--;n>1;)t*=n,n--;return 0==t&&(t=1),t}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.factorial);if(e.valueOf()!==e)return W.factorial(e.valueOf());throw O("factorial",e)},W.random=function(){if(0!=arguments.length)throw x("random",arguments.length,0);return Math.random()},W.max=function(e){if(0==arguments.length)throw Error("Function max requires one or more parameters (0 provided)");if(e instanceof Array||e instanceof r||e instanceof d){if(arguments.length>1)throw Error("Wrong number of parameters (1 matrix or multiple scalars expected)");var n=W.size(e);if(1==n.length){if(0==e.length)throw Error("Cannot calculate max of an empty vector");return z(e.valueOf())}if(2==n.length){if(0==n[0]||0==n[1])throw Error("Cannot calculate max of an empty matrix");if(e instanceof Array)return q(e,n[0],n[1]);if(e instanceof r||e instanceof d)return new r(q(e.valueOf(),n[0],n[1]));throw O("max",e)}throw new RangeError("Cannot calculate max for multi dimensional matrix")}return z(arguments)},W.min=function(e){if(0==arguments.length)throw Error("Function min requires one or more parameters (0 provided)");if(e instanceof Array||e instanceof r||e instanceof d){if(arguments.length>1)throw Error("Wrong number of parameters (1 matrix or multiple scalars expected)");var n=W.size(e);if(1==n.length){if(0==e.length)throw Error("Cannot calculate min of an empty vector");return I(e.valueOf())}if(2==n.length){if(0==n[0]||0==n[1])throw Error("Cannot calculate min of an empty matrix");if(e instanceof Array)return P(e,n[0],n[1]);if(e instanceof r||e instanceof d)return new r(P(e.valueOf(),n[0],n[1]));throw O("min",e)}throw new RangeError("Cannot calculate min for multi dimensional matrix")}return I(arguments)},W.acos=function(e){if(1!=arguments.length)throw x("acos",arguments.length,1);if(g(e))return e>=-1&&1>=e?Math.acos(e):W.acos(new t(e,0));if(e instanceof t){var n=new t(e.im*e.im-e.re*e.re+1,-2*e.re*e.im),i=W.sqrt(n),a=new t(i.re-e.im,i.im+e.re),o=W.log(a);return new t(1.5707963267948966-o.im,o.re)}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.acos);if(e.valueOf()!==e)return W.acos(e.valueOf());throw O("acos",e)},W.asin=function(e){if(1!=arguments.length)throw x("asin",arguments.length,1);if(g(e))return e>=-1&&1>=e?Math.asin(e):W.asin(new t(e,0));if(e instanceof t){var n=e.re,i=e.im,a=new t(i*i-n*n+1,-2*n*i),o=W.sqrt(a),f=new t(o.re-i,o.im+n),s=W.log(f);return new t(s.im,-s.re)}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.asin);if(e.valueOf()!==e)return W.asin(e.valueOf());throw O("asin",e)},W.atan=function(e){if(1!=arguments.length)throw x("atan",arguments.length,1);if(g(e))return Math.atan(e);if(e instanceof t){var n=e.re,i=e.im,a=n*n+(1-i)*(1-i),o=new t((1-i*i-n*n)/a,-2*n/a),f=W.log(o);return new t(-.5*f.im,.5*f.re)}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.atan);if(e.valueOf()!==e)return W.atan(e.valueOf());throw O("atan",e)},W.atan2=function(e,n){if(2!=arguments.length)throw x("atan2",arguments.length,2);if(g(e)){if(g(n))return Math.atan2(e,n);if(n instanceof t)return Math.atan2(e,n.re)}else if(e instanceof t){if(g(n))return Math.atan2(e.re,n);if(n instanceof t)return Math.atan2(e.re,n.re)}if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W.atan2);if(n.valueOf()!==n||e.valueOf()!==e)return W.atan2(e.valueOf(),n.valueOf());throw O("atan2",e,n)},W.cos=function(e){if(1!=arguments.length)throw x("cos",arguments.length,1);if(g(e))return Math.cos(e);if(e instanceof t)return new t(.5*Math.cos(e.re)*(Math.exp(-e.im)+Math.exp(e.im)),.5*Math.sin(e.re)*(Math.exp(-e.im)-Math.exp(e.im)));if(e instanceof E){if(!e.hasBase(E.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return Math.cos(e.value)}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.cos);if(e.valueOf()!==e)return W.cos(e.valueOf());throw O("cos",e)},W.cot=function(e){if(1!=arguments.length)throw x("cot",arguments.length,1);if(g(e))return 1/Math.tan(e);if(e instanceof t){var n=Math.exp(-4*e.im)-2*Math.exp(-2*e.im)*Math.cos(2*e.re)+1;return new t(2*Math.exp(-2*e.im)*Math.sin(2*e.re)/n,(Math.exp(-4*e.im)-1)/n)}if(e instanceof E){if(!e.hasBase(E.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return 1/Math.tan(e.value)}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.cot);if(e.valueOf()!==e)return W.cot(e.valueOf());throw O("cot",e)},W.csc=function(e){if(1!=arguments.length)throw x("csc",arguments.length,1);if(g(e))return 1/Math.sin(e);if(e instanceof t){var n=.25*(Math.exp(-2*e.im)+Math.exp(2*e.im))-.5*Math.cos(2*e.re);return new t(.5*Math.sin(e.re)*(Math.exp(-e.im)+Math.exp(e.im))/n,.5*Math.cos(e.re)*(Math.exp(-e.im)-Math.exp(e.im))/n)}if(e instanceof E){if(!e.hasBase(E.BASE_UNITS.ANGLE))throw new TypeError("Unit in function csc is no angle");return 1/Math.sin(e.value)}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.csc);if(e.valueOf()!==e)return W.csc(e.valueOf());throw O("csc",e)},W.sec=function(e){if(1!=arguments.length)throw x("sec",arguments.length,1);if(g(e))return 1/Math.cos(e);if(e instanceof t){var n=.25*(Math.exp(-2*e.im)+Math.exp(2*e.im))+.5*Math.cos(2*e.re);return new t(.5*Math.cos(e.re)*(Math.exp(-e.im)+Math.exp(e.im))/n,.5*Math.sin(e.re)*(Math.exp(e.im)-Math.exp(-e.im))/n)}if(e instanceof E){if(!e.hasBase(E.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sec is no angle");return 1/Math.cos(e.value)}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.sec);if(e.valueOf()!==e)return W.sec(e.valueOf());throw O("sec",e)},W.sin=function(e){if(1!=arguments.length)throw x("sin",arguments.length,1);if(g(e))return Math.sin(e);if(e instanceof t)return new t(.5*Math.sin(e.re)*(Math.exp(-e.im)+Math.exp(e.im)),.5*Math.cos(e.re)*(Math.exp(e.im)-Math.exp(-e.im)));if(e instanceof E){if(!e.hasBase(E.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return Math.sin(e.value)}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.sin);if(e.valueOf()!==e)return W.sin(e.valueOf());throw O("sin",e)},W.tan=function(e){if(1!=arguments.length)throw x("tan",arguments.length,1);if(g(e))return Math.tan(e);if(e instanceof t){var n=Math.exp(-4*e.im)+2*Math.exp(-2*e.im)*Math.cos(2*e.re)+1;return new t(2*Math.exp(-2*e.im)*Math.sin(2*e.re)/n,(1-Math.exp(-4*e.im))/n)}if(e instanceof E){if(!e.hasBase(E.BASE_UNITS.ANGLE))throw new TypeError("Unit in function tan is no angle");return Math.tan(e.value)}if(e instanceof Array||e instanceof r||e instanceof d)return Z.map(e,W.tan);if(e.valueOf()!==e)return W.tan(e.valueOf());throw O("tan",e)},W["in"]=function(e,n){if(2!=arguments.length)throw x("in",arguments.length,2);if(e instanceof E&&(n instanceof E||y(n)))return e.in(n);if(e instanceof Array||e instanceof r||e instanceof d||n instanceof Array||n instanceof r||n instanceof d)return Z.map2(e,n,W["in"]);if(e.valueOf()!==e)return W["in"](e.valueOf());throw O("in",e,n)},W.chain=function(e){return new W.type.Chain(e)},W.clone=function(n){if(1!=arguments.length)throw x("clone",arguments.length,1);if(null==n)return n;if("function"==typeof n.clone)return n.clone();if(g(n)||y(n)||e(n))return n;if(n instanceof Array){var t=W.clone;return n.map(function(e){return t(e)})}if(n instanceof Object)return Z.mapObject(n,W.clone);throw O("clone",n)},W.format=function(e,n){var t=arguments.length;if(1!=t&&2!=t)throw x("format",t,1,2);if(1==t){var r=arguments[0];return g(r)?Z.formatNumber(r):r instanceof Array?Z.formatArray(r):y(r)?'"'+r+'"':r instanceof Object?""+r:r+""}if(!y(e))throw new TypeError("String expected as first parameter in function format");if(!(n instanceof Object))throw new TypeError("Object expected as first parameter in function format");return e.replace(/\$([\w\.]+)/g,function(e,t){for(var r=t.split("."),i=n[r.shift()];r.length&&void 0!=i;){var a=r.shift();i=a?i[a]:i+"."}return void 0!=i?i:e})},W["import"]=function(e,n){var t;if(y(e)){if("undefined"==typeof require)throw Error("Cannot load file: require not available.");var r=require(e);W["import"](r)}else if(C(e)){if(t=e.name,!t)throw Error("Cannot import an unnamed function");(n||void 0===W[t])&&(W[t]=e)}else if(e instanceof Object)for(t in e)if(e.hasOwnProperty(t)){var i=e[t];C(i)?(n||void 0===W[t])&&(W[t]=i):W["import"](i)}},W["typeof"]=function(e){if(1!=arguments.length)throw x("typeof",arguments.length,1);var n=typeof e;if("object"==n){if(null==e)return"null";if(e.constructor){for(var t in W)if(W.hasOwnProperty(t)&&e.constructor==W[t])return t.toLowerCase();if(e.constructor.name)return e.constructor.name.toLowerCase()}}return n},W.expr.node.Node=B,B.prototype.eval=function(){throw Error("Cannot evaluate a Node interface")},B.prototype.toString=function(){return""},G.prototype=new B,W.expr.node.Symbol=G,G.prototype.hasParams=function(){return void 0!=this.params&&this.params.length>0},G.prototype.eval=function(){var e=this.fn;if(void 0===e)throw Error("Undefined symbol "+this.name);var n=this.params.map(function(e){return e.eval()});return e.apply(this,n)},G.prototype.toString=function(){if(this.name&&!this.params)return this.name;var e=this.name;return this.params&&this.params.length&&(e+="("+this.params.join(", ")+")"),e},V.prototype=new B,W.expr.node.Constant=V,V.prototype.eval=function(){return this.value},V.prototype.toString=function(){return this.value?W.format(this.value):""},D.prototype=new B,W.expr.node.MatrixNode=D,function(){function e(n){return n.map(function(n){return n instanceof Array?e(n):n.eval()})}function n(e){for(var n=[],t=e.length,i=0;t>i;i++){for(var a=e[i],o=a.length,f=null,s=null,u=0;o>u;u++){var c,l=W.clone(a[u]);if(l instanceof r){if(c=l.size(),l=l.valueOf(),1==c.length)l=[l],c=[1,c[0]];else if(c.length>2)throw Error("Cannot merge a multi dimensional matrix")}else l instanceof d?(l=[l.valueOf()],c=[1,l[0].length]):(c=[1,1],l=[[l]]);if(null==f)f=l,s=c[0];else{if(c[0]!=s)throw Error("Dimension mismatch ("+c[0]+" != "+s+")");for(var h=0;s>h;h++)f[h]=f[h].concat(l[h])}}n=n.concat(f)}return n}function t(e){return e.some(function(e){return e instanceof r||e instanceof d?!0:e instanceof Array?t(e):!1})}D.prototype.eval=function(){var i=e(this.nodes);return t(i)&&(i=n(i)),new r(i)},D.prototype.toString=function(){return Z.formatArray(this.nodes)
}}(),k.prototype=new B,W.expr.node.Block=k,k.prototype.add=function(e,n){var t=this.params.length;this.params[t]=e,this.visible[t]=void 0!=n?n:!0},k.prototype.eval=function(){for(var e=[],n=0,t=this.params.length;t>n;n++){var r=this.params[n].eval();this.visible[n]&&e.push(r)}return e},k.prototype.toString=function(){for(var e=[],n=0,t=this.params.length;t>n;n++)this.visible[n]&&e.push("\n  "+(""+this.params[n]));return"["+e.join(",")+"\n]"},F.prototype=new B,W.expr.node.Assignment=F,F.prototype.eval=function(){if(void 0===this.expr)throw Error("Undefined symbol "+this.name);var e,n=this.params;if(n&&n.length){var t=[];this.params.forEach(function(e){t.push(e.eval())});var r=this.expr.eval();if(void 0==this.result.value)throw Error("Undefined symbol "+this.name);var i=this.result();if(!i.set)throw new TypeError("Cannot apply a subset to object of type "+W.typeof(i));e=i.set(t,r),this.result.value=e}else e=this.expr.eval(),this.result.value=e;return e},F.prototype.toString=function(){var e="";return e+=this.name,this.params&&this.params.length&&(e+="("+this.params.join(", ")+")"),e+=" = ",e+=""+this.expr},H.prototype=new B,W.expr.node.Arguments=H,H.prototype.eval=function(){var e=this.object;if(void 0==e)throw Error("Node undefined");for(var n=e.eval(),t=this.params,r=[],i=0,a=t.length;a>i;i++)r[i]=t[i].eval();if(!n.get)throw new TypeError("Cannot apply arguments to object of type "+W.typeof(n));return n.get(r)},H.prototype.toString=function(){var e=this.object?""+this.object:"";return this.params&&(e+="("+this.params.join(", ")+")"),e},j.prototype=new B,W.expr.node.FunctionAssignment=j,j.prototype.createFunction=function(e,n,t,r){var i=function(){var n=t?t.length:0,i=arguments?arguments.length:0;if(n!=i)throw x(e,i,n);if(n>0)for(var a=0;n>a;a++)t[a].value=arguments[a];return r.eval()};return i.toString=function(){return e+"("+n.join(", ")+")"},i},j.prototype.eval=function(){for(var e=this.variables,n=this.values,t=0,r=e.length;r>t;t++)e[t].value=n[t];return this.result.value=this.def,this.def},j.prototype.toString=function(){return""+this.def},W.expr.Scope=function(e){this.parentScope=e,this.nestedScopes=void 0,this.symbols={},this.defs={},this.updates={},this.links={}},W.expr.Scope.prototype={createNestedScope:function(){var e=new W.expr.Scope(this);return this.nestedScopes||(this.nestedScopes=[]),this.nestedScopes.push(e),e},clear:function(){if(this.symbols={},this.defs={},this.links={},this.updates={},this.nestedScopes)for(var e=this.nestedScopes,n=0,t=e.length;t>n;n++)e[n].clear()},createSymbol:function(e){var n=this.symbols[e];if(!n){var t=this.findDef(e);n=this.newSymbol(e,t),this.symbols[e]=n}return n},newSymbol:function(e,n){var t=this,i=function(){var n,a;if(!i.value&&(i.value=t.findDef(e),!i.value))throw Error("Undefined symbol "+e);if("function"==typeof i.value)return i.value.apply(null,arguments);if(i.value instanceof r||i.value instanceof d||i.value instanceof Array){if(arguments.length){var o=i.value instanceof Array?new r(i.value):i.value;for(n=[],a=0;arguments.length>a;a++)n[a]=arguments[a];return o.get(n)}return i.value}return i.value};return i.value=n,i.toString=function(){return i.value?""+i.value:""},i},createLink:function(e){var n=this.links[e];return n||(n=this.createSymbol(e),this.links[e]=n),n},createDef:function(e,n){var t=this.defs[e];return t||(t=this.createSymbol(e),this.defs[e]=t),t&&void 0!=n&&(t.value=n),t},createUpdate:function(e){var n=this.updates[e];return n||(n=this.createLink(e),this.updates[e]=n),n},createConstant:function(e,n){var t=this.newSymbol(e,n);return this.symbols[e]=t,this.defs[e]=t,t},findDef:function(e){var n;if(n=this.defs[e])return n;if(n=this.updates[e])return n;if(this.parentScope)return this.parentScope.findDef(e);var t=W[e];if(t)return this.createConstant(e,t);if(E.isPlainUnit(e)){var r=new E(null,e);return this.createConstant(e,r)}return void 0},removeLink:function(e){delete this.links[e]},removeDef:function(e){delete this.defs[e]},removeUpdate:function(e){delete this.updates[e]},init:function(){var e=this.symbols,n=this.parentScope;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];r.value=n?n.findDef(t):void 0}this.nestedScopes&&this.nestedScopes.forEach(function(e){e.init()})},hasLink:function(e){if(this.links[e])return!0;if(this.nestedScopes)for(var n=this.nestedScopes,t=0,r=n.length;r>t;t++)if(n[t].hasLink(e))return!0;return!1},hasDef:function(e){return void 0!=this.defs[e]},hasUpdate:function(e){return void 0!=this.updates[e]},getUndefinedSymbols:function(){var e=this.symbols,n=[];for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];void 0==r.value&&n.push(r)}return this.nestedScopes&&this.nestedScopes.forEach(function(e){n=n.concat(e.getUndefinedSymbols())}),n}},function(){function e(){Z++,K=Y.charAt(Z)}function n(){Z=0,K=Y.charAt(0)}function r(){for(Q=H.NULL,X="";" "==K||"	"==K;)e();if("#"==K)for(;"\n"!=K&&""!=K;)e();if(""==K)return Q=H.DELIMITER,void 0;if("-"==K||","==K||"("==K||")"==K||"["==K||"]"==K||'"'==K||"\n"==K||";"==K||":"==K||"!"==K||"'"==K)return Q=H.DELIMITER,X+=K,e(),void 0;if(i(K))for(Q=H.DELIMITER;i(K);)X+=K,e();else if(o(K)){for(Q=H.NUMBER;o(K);)X+=K,e();if("E"==K||"e"==K)for(X+=K,e(),("+"==K||"-"==K)&&(X+=K,e()),f(K)||(Q=H.UNKNOWN);f(K);)X+=K,e()}else{if(!a(K)){for(Q=H.UNKNOWN;""!=K;)X+=K,e();throw I('Syntax error in part "'+X+'"')}for(Q=H.SYMBOL;a(K)||f(K);)X+=K,e()}}function i(e){return"&"==e||"|"==e||"<"==e||">"==e||"="==e||"+"==e||"/"==e||"*"==e||"%"==e||"^"==e||","==e||";"==e||"\n"==e||"!"==e||"'"==e}function a(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e||"_"==e}function o(e){return e>="0"&&"9">=e||"."==e}function f(e){return e>="0"&&"9">=e}function s(e){n(),r();var t;if(t=""==X?new V(void 0):u(e),""!=X)throw Q==H.DELIMITER?C("Unknown operator "+X):I('Unexpected part "'+X+'"');return t}function u(e){var n,t,i;for("\n"!=X&&";"!=X&&""!=X&&(n=c(e));"\n"==X||";"==X;)t||(t=new k,n&&(i=";"!=X,t.add(n,i))),r(),"\n"!=X&&";"!=X&&""!=X&&(n=c(e),i=";"!=X,t.add(n,i));return t?t:(n||(n=c(e)),n)}function c(e){var n=l(e);if(!(n instanceof F)){var t="ans",r=void 0,i=e.createDef(t);return new F(t,r,n,i)}return n}function l(e){if(Q==H.SYMBOL&&"function"==X){if(r(),Q!=H.SYMBOL)throw I("Function name expected");var n=X;if(r(),"("!=X)throw I("Opening parenthesis ( expected");for(var t=e.createNestedScope(),i=[],a=[];;){if(r(),Q!=H.SYMBOL)throw I("Variable name expected");var o=X,f=t.createDef(o);if(i.push(o),a.push(f),r(),","!=X){if(")"==X)break;throw I('Comma , or closing parenthesis ) expected"')}}if(r(),"="!=X)throw I("Equal sign = expected");r();var s=m(t),u=e.createDef(n);return new j(n,i,a,s,u)}return h(e)}function h(e){var n=!1;Q==H.SYMBOL&&(n=e.hasLink(X));var t=m(e);if("="==X){if(!(t instanceof G))throw I("Symbol expected at the left hand side of assignment operator =");var i=t.name,a=t.params;n||e.removeLink(i),r();var o=m(e),f=t.hasParams()?e.createUpdate(i):e.createDef(i);return new F(i,a,o,f)}return t}function m(e){var n=p(e);if(":"==X){for(var t=[n];":"==X;)r(),t.push(p(e));if(t.length>3)throw new TypeError("Invalid range");var i="range",a=W.range;n=new G(i,a,t)}return n}function p(e){for(var n=v(e),t={"in":"in"};void 0!==t[X];){var i=X,a=W[t[i]];r();var o=[n,v(e)];n=new G(i,a,o)}return n}function v(e){var n=g(e);return n}function g(e){for(var n=w(e),t={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallereq",">=":"largereq"};void 0!==t[X];){var i=X,a=W[t[i]];r();var o=[n,w(e)];n=new G(i,a,o)}return n}function w(e){for(var n=d(e),t={"+":"add","-":"subtract"};void 0!==t[X];){var i=X,a=W[t[i]];r();var o=[n,d(e)];n=new G(i,a,o)}return n}function d(e){for(var n=y(e),t={"*":"multiply","/":"divide","%":"mod",mod:"mod"};void 0!==t[X];){var i=X,a=W[t[i]];r();var o=[n,y(e)];n=new G(i,a,o)}return n}function y(e){if("-"==X){var n=X,t=W.unaryminus;r();var i=[N(e)];return new G(n,t,i)}return N(e)}function N(e){for(var n=[O(e)];"^"==X;)r(),n.push(O(e));for(var t=n.pop();n.length;){var i=n.pop(),a="^",o=W.pow,f=[i,t];t=new G(a,o,f)}return t}function O(e){for(var n=x(e);"!"==X;){var t=X,i=W.factorial;r();var a=[n];n=new G(t,i,a)}return n}function x(e){for(var n=b(e);"'"==X;){var t=X,i=W.transpose;r();var a=[n];n=new G(t,i,a)}return n}function b(e){return M(e)}function M(e){if(Q==H.SYMBOL){var n=X;r();var t=e.createLink(n),i=A(e),a=new G(n,t,i);return a}return S(e)}function A(e){var n=[];if("("==X){if(r(),")"!=X)for(n.push(m(e));","==X;)r(),n.push(m(e));if(")"!=X)throw I("Parenthesis ) missing");r()}return n}function S(n){if('"'==X){for(var t="",i="";""!=K&&('"'!=K||"\\"==i);)t+=K,i=K,e();if(r(),'"'!=X)throw I('End of string " missing');r();var a=new V(t);return a}return T(n)}function T(e){if("["==X){var n;for(r();"\n"==X;)r();if("]"!=X){var t=[],i=0,a=0;for(t[0]=[m(e)];","==X||";"==X;){for(","==X?a++:(i++,a=0,t[i]=[]),r();"\n"==X;)r();for(t[i][a]=m(e);"\n"==X;)r()}var o=t.length,f=t.length>0?t[0].length:0;for(i=1;o>i;i++)if(t[i].length!=f)throw C("Number of columns must match ("+t[i].length+" != "+f+")");if("]"!=X)throw I("End of matrix ] missing");r(),n=new D(t)}else r(),n=new D([[]]);return n}return U(e)}function U(e){if(Q==H.NUMBER){var n;n="."==X?0:Number(X),r();var i;if(Q==H.SYMBOL){if("i"==X||"I"==X)return i=new t(0,n),r(),new V(i);if(E.isPlainUnit(X))return i=new E(n,X),r(),new V(i);throw P('Unknown unit "'+X+'"')}var a=new V(n);return a}return L(e)}function L(e){if("("==X){r();var n=m(e);if(")"!=X)throw I("Parenthesis ) expected");return r(),n}return R(e)}function R(){throw""==X?I("Unexpected end of expression"):I("Value expected")}function _(){return void 0}function z(){return Z-X.length+1}function q(e){var n=_(),t=z();return void 0===n?void 0===t?e:e+" (char "+t+")":e+" (line "+n+", char "+t+")"}function I(e){return new SyntaxError(q(e))}function P(e){return new TypeError(q(e))}function C(e){return Error(q(e))}W.expr.Parser=function B(){if(this.constructor!=B)throw new SyntaxError("Parser constructor must be called with the new operator");this.scope=new W.expr.Scope},W.expr.Parser.prototype.parse=function(e,n){return Y=e||"",n||(n=this.scope),s(n)},W.expr.Parser.prototype.eval=function(e){var n=this.parse(e);return n.eval()},W.expr.Parser.prototype.get=function(e){var n=this.scope.findDef(e);return n?n.value:void 0},W.expr.Parser.prototype.set=function(e,n){this.scope.createDef(e,n)},W.expr.Parser.prototype.clear=function(){this.scope.clear()};var H={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},Y="",Z=0,K="",X="",Q=H.NULL}(),function(){function e(){this.idMax=-1,this.updateSeq=0,this.parser=new W.expr.Parser,this.scope=new W.expr.Scope,this.nodes={},this.firstNode=void 0,this.lastNode=void 0}W.expr.Workspace=e,e.prototype.clear=function(){this.nodes={},this.firstNode=void 0,this.lastNode=void 0},e.prototype.append=function(n){var t=this._getNewId(),r=this.lastNode?this.lastNode.scope:this.scope,i=new W.expr.Scope(r),a=new e.Node({id:t,expression:n,parser:this.parser,scope:i,nextNode:void 0,previousNode:this.lastNode});return this.nodes[t]=a,this.firstNode||(this.firstNode=a),this.lastNode&&(this.lastNode.nextNode=a),this.lastNode=a,this._update([t]),t},e.prototype.insertBefore=function(n,t){var r=this.nodes[t];if(!r)throw'Node with id "'+t+'" not found';var i=r.previousNode,a=this._getNewId(),o=i?i.scope:this.scope,f=new W.expr.Scope(o),s=new e.Node({id:a,expression:n,parser:this.parser,scope:f,nextNode:r,previousNode:i});this.nodes[a]=s,i?i.nextNode=s:this.firstNode=s,r.previousNode=s,r.scope.parentScope=s.scope;var u=this.getDependencies(a);return-1==u.indexOf(a)&&u.unshift(a),this._update(u),a},e.prototype.insertAfter=function(e,n){var t=this.nodes[n];if(!t)throw'Node with id "'+n+'" not found';return t==this.lastNode?this.append(e):this.insertBefore(n+1,e)},e.prototype.remove=function(e){var n=this.nodes[e];if(!n)throw'Node with id "'+e+'" not found';var t=this.getDependencies(e),r=n.previousNode,i=n.nextNode;r?r.nextNode=i:this.firstNode=i,i?i.previousNode=r:this.lastNode=r;var a=r?r.scope:this.scope;i&&(i.scope.parentScope=a),delete this.nodes[e],this._update(t)},e.prototype.replace=function(n,t){var r=this.nodes[t];if(!r)throw'Node with id "'+t+'" not found';var i=[t];e._merge(i,this.getDependencies(t));var a=r.previousNode;r.nextNode,a?a.scope:this.scope,r.setExpr(n),e._merge(i,this.getDependencies(t)),this._update(i)},e.Node=function(e){this.id=e.id,this.parser=e.parser,this.scope=e.scope,this.nextNode=e.nextNode,this.previousNode=e.previousNode,this.updateSeq=0,this.result=void 0,this.setExpr(e.expression)},e.Node.prototype.setExpr=function(e){this.expression=e||"",this.scope.clear(),this._parse()},e.Node.prototype.getExpr=function(){return this.expression},e.Node.prototype.getResult=function(){return this.result},e.Node.prototype._parse=function(){try{this.fn=this.parser.parse(this.expression,this.scope)}catch(e){var n="Error: "+((e.message||e)+"");this.fn=new V(n)}},e.Node.prototype.eval=function(){try{this.scope.init(),this.result=this.fn.eval()}catch(e){this.scope.init(),this.result="Error: "+((e.message||e)+"")}return this.result},e._merge=function(e,n){for(var t=0,r=n.length;r>t;t++){var i=n[t];-1==e.indexOf(i)&&e.push(i)}},e.prototype.getDependencies=function(n){var t,r=[],i=this.nodes[n];if(i){var a=i.scope.defs,o=i.scope.updates,f=[];for(t in a)a.hasOwnProperty(t)&&f.push(t);for(t in o)o.hasOwnProperty(t)&&-1==f.indexOf(t)&&f.push(t);for(var s=i.nextNode;s&&f.length;){for(var u=s.scope,c=0;f.length>c;){if(t=f[c],(u.hasLink(t)||u.hasUpdate(t))&&-1==r.indexOf(s.id)){r.push(s.id);var l=this.getDependencies(s.id);e._merge(r,l)}u.hasDef(t)&&(f.splice(c,1),c--),c++}s=s.nextNode}}return r},e.prototype.getExpr=function(e){var n=this.nodes[e];if(!n)throw'Node with id "'+e+'" not found';return n.getExpr()},e.prototype.getResult=function(e){var n=this.nodes[e];if(!n)throw'Node with id "'+e+'" not found';return n.getResult()},e.prototype._update=function(e){this.updateSeq++;for(var n=this.updateSeq,t=this.nodes,r=0,i=e.length;i>r;r++){var a=e[r],o=t[a];o&&(o.eval(),o.updateSeq=n)}},e.prototype.getChanges=function(e){var n=[],t=this.firstNode;for(e=e||0;t;)t.updateSeq>e&&n.push(t.id),t=t.nextNode;return{ids:n,updateSeq:this.updateSeq}},e.prototype._getNewId=function(){return this.idMax++,this.idMax},e.prototype.toString=function(){return JSON.stringify(this.toJSON())},e.prototype.toJSON=function(){for(var e=[],n=this.firstNode;n;){var t={id:n.id,expression:n.expression,dependencies:this.getDependencies(n.id)};try{t.result=n.getResult()}catch(r){t.result="Error: "+((r.message||r)+"")}e.push(t),n=n.nextNode}return e}}(),W.Complex=function(){Y("new math.Complex()","math.complex()")},W.Unit=function(){Y("new math.Unit()","math.unit()")},W.parser.Parser=function(){Y("new math.parser.Parser()","math.parser()")},W.parser.Workspace=function(){Y("new math.parser.Workspace()","math.workspace()")};for(var $ in W)W.hasOwnProperty($)&&$&&n($,W[$])})();